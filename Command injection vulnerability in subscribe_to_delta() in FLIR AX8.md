# Command injection vulnerability in subscribe_to_delta() in FLIR AX8

### Description

Command injection vulnerability in /usr/www/application/models/subscriptions.php  in FLIR AX8 up to 1.46.16 allows attackers to run arbitrary commands via the function subscribe_to_delta()

![image-20250528203940124](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282039265.png)

### Note:

This vulnerability is a backend issue that requires obtaining cookies. It  can exploit the unauthorized access vulnerability for arbitrary user  registration found at /tools/test_login.php?action=register. After  registering a new user, cookies can be obtained to achieve RCE (Remote  Code Execution). 

Also.Under normal circumstances, it has a weak password vulnerability with  default account credentials being 'admin' for both user and password too.  You can also obtain a cookie through this method.

### POC

```bash
curl -i "http://target_ip:port/home/subscribe/delta/;id>poc.txt;" --cookie "PHPSESSID=xxxxxxx"
```

![image-20250528204417392](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282044541.png)

![image-20250528203825966](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282038020.png)



### Analysis

The line184  subscribe_to_delta() can trigger the command execute of shell_exec(), and the param $id  is user can control

![image-20250528204535321](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282045363.png)

![image-20250528204632136](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282046179.png)
